import{p as f,w as g,D as $,E as x,o as b,b as h,h as s,v as a,t as _,e as D,n as A,y as N,G as w,H as V,A as B,C as M,k,l as R,I as T,f as U}from"./app-BArZ-JoB.js";import{A as q}from"./AppTopbar-Bll2YKxL.js";import{u as G,A as O}from"./AppFooter-DRZBUV_0.js";import{u as F}from"./player-Czj22g4O.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"reproductor"},j={class:"cancion-detalles"},z={class:"cancion-img"},J=["src"],K={class:"cancion-info"},Q={key:0},W={key:1},X={key:2,id:"cancion-autor"},Y={class:"cancion-acciones"},Z={class:"barra-progreso-span"},ee=["max","value"],oe={class:"progreso-tiempo"},te={class:"controles"},se={class:"barra-volumen-span"},ae={__name:"AppReproductorGlobal",setup(L){const e=F(),u=f(.2),v=f(0),l=f(!1);function p(t){V.post(`/api/reproducciones/${t}`).then(o=>{console.log("Reproducción registrada",o.data)}).catch(o=>{console.error("Error al registrar reproducción",o)})}g(()=>e.currentSong,t=>{t&&t.id&&p(t.id)});function S(t){return t!=null&&t.portada?t.portada:"/images/placeholder.jpg"}function d(){console.log("Click en play/pause. Estado:",{isPlaying:e.isPlaying,progress:e.progress,soundExists:!!e.sound}),e.togglePlay()}function m(){const t=u.value*100,o=document.querySelector(".barra-volumen");o&&o.style.setProperty("--volume-percent",`${t}%`)}function C(){e.setVolume(u.value),m()}function P(){v.value=e.progress,l.value=!0}function y(){l.value&&(e.setSeek(v.value),l.value=!1)}function r(t){l.value&&(v.value=parseFloat(t.target.value))}function c(t){if(!t||isNaN(t))return"0:00";const o=Math.floor(t/60),n=Math.floor(t%60);return`${o}:${n<10?"0"+n:n}`}function i(){const t=document.querySelector(".barra-progreso");if(t){const o=e.progress/(e.duration||1)*100;t.style.setProperty("--progress-percent",`${o}%`)}}return g(()=>e.volume,t=>{t!==u.value&&(u.value=t,m())}),g(()=>e.progress,()=>{l.value||i()}),g(()=>u.value,()=>{m()}),g(()=>e.isPlaying,()=>{i()}),$(()=>{e.volume?u.value=e.volume:e.sound&&(u.value=e.sound.volume()),e.setVolume(u.value),m(),window.addEventListener("mouseup",y);const t=setInterval(()=>{e.sound&&e.sound.playing()!==e.isPlaying&&(e.isPlaying=e.sound.playing())},1e3);x(()=>{window.removeEventListener("mouseup",y),clearInterval(t)})}),(t,o)=>(b(),h("div",H,[s("div",j,[s("div",z,[s("img",{src:S(a(e).currentSong),alt:"Portada del álbum"},null,8,J)]),s("div",K,[a(e).currentSong?(b(),h("p",Q,_(a(e).currentSong.nombre),1)):(b(),h("p",W,"No hay canción")),a(e).currentSong?(b(),h("p",X,_(a(e).currentSong.autor),1)):D("",!0)])]),s("div",Y,[s("span",Z,[s("input",{type:"range",min:"0",max:a(e).duration||1,value:l.value?v.value:a(e).progress,onMousedown:P,onMouseup:y,onInput:r,class:"barra-progreso"},null,40,ee),s("div",oe,[s("span",null,_(c(l.value?v.value:a(e).progress)),1),s("span",null,_(c(a(e).duration)),1)])]),s("div",te,[s("button",{onClick:o[0]||(o[0]=(...n)=>a(e).toggleShuffle&&a(e).toggleShuffle(...n)),class:A(["boton-controles",{activo:a(e).isShuffle}])},o[5]||(o[5]=[s("i",{class:"fa-solid fa-shuffle"},null,-1)]),2),s("button",{class:"cambiar-cancion",onClick:o[1]||(o[1]=(...n)=>a(e).prevSong&&a(e).prevSong(...n))},"⏮"),s("button",{class:"play-button",onClick:d},_(a(e).isPlaying?"⏸":"▶"),1),s("button",{class:"cambiar-cancion",onClick:o[2]||(o[2]=(...n)=>a(e).nextSong&&a(e).nextSong(...n))},"⏭"),s("button",{onClick:o[3]||(o[3]=(...n)=>a(e).toggleLoop&&a(e).toggleLoop(...n)),class:A(["boton-controles",{activo:a(e).isLoop}])},o[6]||(o[6]=[s("i",{class:"fa-solid fa-repeat"},null,-1)]),2)]),s("span",se,[o[7]||(o[7]=s("i",{class:"pi pi-volume-up"},null,-1)),N(s("input",{type:"range",min:"0",max:"1",step:"0.01","onUpdate:modelValue":o[4]||(o[4]=n=>u.value=n),onInput:C,class:"barra-volumen"},null,544),[[w,u.value]])])])]))}},ne=I(ae,[["__scopeId","data-v-f34a0048"]]),le={class:"layout-main-home"},re={class:"layout-main"},ue={class:"layout-main-content"},ie={class:"layout-reproductor"},ce={__name:"AuthenticatedUser",setup(L){const e=B();M(()=>e.user);const u=R(),v=T();f({icon:"pi pi-home",route:"/app"}),M(()=>{let r=u.path.split("/");return r.shift(),r.reduce((i,t,o)=>{var n,E;return i.push({route:i[o-1]?""+i[o-1].route+"/"+t:"/"+t,label:((n=u.matched[o])==null?void 0:n.meta.breadCrumb)||t,disabled:o+1===r.length||((E=u.matched[o])==null?void 0:E.meta.linked)===!1}),i},[])}),f([{separator:!0},{label:"Documents",items:[{label:"Tareas",icon:"pi pi-plus",command:()=>{v.push({name:"app.tasks"})}},{label:"Search",icon:"pi pi-search"}]}]);const{layoutConfig:l,layoutState:p,isSidebarActive:S}=G(),d=f(null);g(S,r=>{r?C():P()});const m=M(()=>({"layout-theme-light":l.darkTheme.value==="light","layout-theme-dark":l.darkTheme.value==="dark","layout-overlay":l.menuMode.value==="overlay","layout-static":l.menuMode.value==="static","layout-static-inactive":p.staticMenuDesktopInactive.value&&l.menuMode.value==="static","layout-overlay-active":p.overlayMenuActive.value,"layout-mobile-active":p.staticMenuMobileActive.value,"p-input-filled":l.inputStyle.value==="filled","p-ripple-disabled":!l.ripple.value})),C=()=>{d.value||(d.value=r=>{y(r)&&(p.overlayMenuActive.value=!1,p.staticMenuMobileActive.value=!1,p.menuHoverActive.value=!1)},document.addEventListener("click",d.value))},P=()=>{d.value&&(document.removeEventListener("click",d),d.value=null)},y=r=>{const c=document.querySelector(".layout-sidebar"),i=document.querySelector(".layout-menu-button");return!(c.isSameNode(r.target)||c.contains(r.target)||i.isSameNode(r.target)||i.contains(r.target))};return(r,c)=>{const i=U("router-view");return b(),h("div",{class:A(["layout-home",m.value])},[k(q),s("div",le,[s("div",re,[s("div",ue,[k(i)]),k(O,{class:"footer"})]),s("div",ie,[k(ne)])]),c[0]||(c[0]=s("div",{class:"layout-mask"},null,-1))],2)}}},fe=I(ce,[["__scopeId","data-v-eeffe776"]]);export{fe as default};
