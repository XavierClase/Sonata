import{p as r,A as L,R as P,H as f}from"./app-BArZ-JoB.js";function j(a){const s=r(null);return{user:s,getUser:async()=>{try{const t=await f.get(`/api/user/${a.value}`);s.value=t.data.data}catch(t){console.error("Error los datos del usuario",t)}}}}function z(a,s,U){var b,E;const t=L().user,m=r(null),g=r(null),n=r(""),i=r(""),D=P({portada:null}),w=P({portada:null}),v=r((b=a.value)==null?void 0:b.avatar),d=r((E=a.value)==null?void 0:E.fotoDetalles),R=(e,u)=>{const l=e.target.files[0];if(l){const o=u==="perfil"?m:g,p=u==="perfil"?D:w;o.value&&URL.revokeObjectURL(o.value),p.portada=l,o.value=URL.createObjectURL(l)}},y=async(e,u,l)=>{if(e.portada){let o=new FormData;o.append("id",t.id),o.append("picture",e.portada);try{const c=(await f.post(u,o,{headers:{"Content-Type":"multipart/form-data"}})).data[l];c&&(l==="avatar"?(v.value=c,a.value.avatar=c):l==="fotoDetalles"&&(d.value=c,a.value.fotoDetalles=c),e.portada=null)}catch(p){console.error(`Error al actualizar la imagen en ${u}:`,p)}}},I=async()=>{try{D.portada&&await y(D,"/api/users/updateimg","avatar"),w.portada&&await y(w,"/api/users/updateimgdetalles","fotoDetalles"),(n.value!==a.value.name||i.value!==a.value.descripcion)&&(await f.put(`/api/users/${s.value}`,{name:n.value,descripcion:i.value}),a.value.name=n.value,a.value.descripcion=i.value,t.name=n.value,t.descripcion=i.value),m.value=null,g.value=null,await h(),v.value&&v.value!==a.value.avatar&&(a.value.avatar=v.value),d.value&&d.value!==a.value.fotoDetalles&&(a.value.fotoDetalles=d.value),t.avatar=a.value.avatar,t.fotoDetalles=a.value.fotoDetalles,U.value=!1}catch(e){console.error("Error al guardar los cambios:",e)}},h=async()=>{try{const e=await f.get(`/api/user/${s.value}`);a.value=e.data.data}catch(e){console.error("Error al actualizar los datos del usuario:",e),window.location.reload()}};return{PreviewImagenPerfil:m,PreviewImagenDetalles:g,nombreUsuarioMod:n,descripcionUsuarioMod:i,manejarImagen:R,guardarCambios:I,fetchUserData:h}}export{j as d,z as u};
