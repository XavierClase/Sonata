import{M as B,p as m,b as l,h as e,k as r,P as E,n as L,t as p,e as v,v as I,f as c,o as i,I as S}from"./app-BArZ-JoB.js";import{u as F}from"./listasAdmin-DBsvEFmU.js";const T={class:"grid"},U={class:"col-12"},j={class:"card"},D={class:"card-header mb-3"},M={class:"flex justify-content-between align-items-center"},N={class:"grid"},R={class:"col-12 md:col-8"},$={class:"grid"},z={class:"col-12"},P={class:"field"},A={key:0,class:"p-error"},G={class:"col-12"},q={class:"field"},H={key:0,class:"p-error"},J={class:"col-12 md:col-4"},K={class:"field"},O={class:"flex flex-column align-items-center"},Q={class:"surface-card border-1 border-round border-300 p-0 mb-3",style:{height:"200px",width:"200px",overflow:"hidden"}},W=["src"],X={key:1,class:"w-full h-full flex align-items-center justify-content-center bg-gray-100"},Y={key:0,class:"p-error mt-2"},Z={class:"col-12 flex justify-content-end mt-4"},te={__name:"Create",setup(ee){const _=S(),f=B(),{storeLista:b,errors:h,loading:g}=F(),s=m({}),u=m(null),a=m({nombre:"",descripcion:"",duracion_total:"00:00:00",portada:null}),x=t=>{a.value.portada=t.files[0];const o=new FileReader;o.onload=n=>{u.value=n.target.result},o.readAsDataURL(t.files[0]),t.files=[]},y=t=>{t.type==="max-file-size"&&(s.value.portada=["El archivo excede el tamaño máximo permitido (2MB)"],f.add({severity:"error",summary:"Error",detail:"El archivo excede el tamaño máximo permitido (2MB)",life:3e3}))},w=async()=>{try{if(s.value={},!a.value.portada){s.value.portada=["La imagen de portada es obligatoria"];return}await b(a.value),f.add({severity:"success",summary:"Éxito",detail:"Lista de reproducción creada correctamente",life:3e3}),_.push("/admin/listas")}catch{s.value=h.value}};return(t,o)=>{const n=c("Button"),k=c("InputText"),V=c("Textarea"),C=c("FileUpload");return i(),l("div",T,[e("div",U,[e("div",j,[e("div",D,[e("div",M,[o[4]||(o[4]=e("h5",{class:"m-0 text-xl font-medium"},"Crear Lista de Reproducción",-1)),r(n,{icon:"pi pi-arrow-left",label:"Volver",class:"p-button-outlined",onClick:o[0]||(o[0]=d=>t.$router.push("/admin/listas"))})])]),e("form",{onSubmit:E(w,["prevent"]),class:"p-fluid"},[e("div",N,[e("div",R,[e("div",$,[e("div",z,[e("div",P,[o[5]||(o[5]=e("label",{for:"nombre",class:"font-medium"},"Nombre de la lista",-1)),r(k,{id:"nombre",modelValue:a.value.nombre,"onUpdate:modelValue":o[1]||(o[1]=d=>a.value.nombre=d),class:L({"p-invalid":s.value.nombre}),placeholder:"Introduce un nombre para la lista"},null,8,["modelValue","class"]),s.value.nombre?(i(),l("small",A,p(s.value.nombre[0]),1)):v("",!0)])]),e("div",G,[e("div",q,[o[6]||(o[6]=e("label",{for:"descripcion",class:"font-medium"},"Descripción",-1)),r(V,{id:"descripcion",modelValue:a.value.descripcion,"onUpdate:modelValue":o[2]||(o[2]=d=>a.value.descripcion=d),rows:"4",placeholder:"Describe brevemente esta lista de reproducción"},null,8,["modelValue"]),s.value.descripcion?(i(),l("small",H,p(s.value.descripcion[0]),1)):v("",!0)])])])]),e("div",J,[e("div",K,[o[8]||(o[8]=e("label",{for:"portada",class:"font-medium mb-2 block"},"Portada",-1)),e("div",O,[e("div",Q,[u.value?(i(),l("img",{key:0,src:u.value,alt:"Vista previa",class:"w-full h-full object-cover"},null,8,W)):(i(),l("div",X,o[7]||(o[7]=[e("i",{class:"pi pi-image text-4xl text-gray-400"},null,-1)])))]),r(C,{mode:"basic",name:"portada",accept:"image/*",maxFileSize:2e6,onSelect:x,onError:y,auto:!1,chooseLabel:"Seleccionar imagen",class:"w-full"}),s.value.portada?(i(),l("small",Y,p(s.value.portada[0]),1)):v("",!0)])])]),e("div",Z,[r(n,{type:"button",label:"Cancelar",class:"p-button-outlined mr-2",onClick:o[3]||(o[3]=d=>t.$router.push("/admin/listas"))}),r(n,{type:"submit",label:"Guardar",icon:"pi pi-save",loading:I(g)},null,8,["loading"])])])],32)])])])}}};export{te as default};
