import{M as Ia,p as r,A as Ra,R as Va,D as $a,b as u,d as ta,e as F,h as e,v as o,t as n,x as _,n as I,W as R,F as ia,i as Ma,k as l,l as Na,f as p,o as c,O as ja,P as za,I as Aa}from"./app-BArZ-JoB.js";import{b as Ga,a as Sa,_ as qa}from"./listaCanciones-BgB1a3n7.js";import{u as Oa}from"./usePlayer-BvTy7vg6.js";import{m as Ha}from"./mostrarMusica-BSXilRiR.js";import{_ as Wa}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./player-Czj22g4O.js";const Ya={class:"lista-banner"},Za={class:"detalles-lista"},Ja={class:"lista-banner-img"},Ka=["src"],Qa={class:"datos-detalles-lista"},Xa={class:"lista-descripcion"},ae={key:0,viewBox:"0 0 100 100"},ee={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},te={class:"lista-canciones-container"},ie={class:"lista-canciones-detalles"},se=["onClick"],oe={class:"col-md-1 num-cancion-lista"},le={class:"col-md-5 cancion-lista-nombre"},ne={class:"col-md-3 cancion-lista-reproducciones"},re={class:"col-md-2 duracion-cancion"},ce={class:"cancion-lista-span"},de=["onClick"],ue=["onClick"],pe=["onClick"],me={class:"row"},ve={class:"config-imagenes col-md-4"},fe={class:"imagen-crear-lista"},ge=["src"],ye={class:"col-md-6"},_e={class:"flex items-center gap-4 mb-4"},be={class:"flex items-center gap-4 mb-8"},Ce={class:"flex justify-end gap-2"},Le={class:"flex justify-end gap-2 mt-4"},ke={class:"flex justify-end gap-2 mt-4"},we={__name:"lista",setup(xe){const m=Ia(),sa=Aa(),oa=Na(),{isPlaying:la,playPlaylist:na,playSong:ra,togglePlay:Ee}=Oa(),E=r(null),h=r(null),v=r(!1),P=r(!1),U=Ra().user,d=r(oa.params.id),{lista:s,canciones:b,getListaData:ca,getCancionesLista:da,updateLista:ua,updateListaImagen:pa,eliminarLista:ma,eliminarCancionDeLista:va}=Ha(d),C=r(""),L=r(""),k=Va({portada:null}),w=r(!1),x=r(!1),f=r(null),{favoritos:he,toggleLike:fa,esFavorito:ga}=Ga(),{cancionesFavoritas:Be,cargarFavoritosCanciones:V,toggleLikeCancion:ya,esFavoritaCancion:_a}=Sa(),B=r(!1),ba=()=>{na(b.value,"lista",s.value.id)},Ca=i=>{ra(i,b.value,"lista",s.value.id)},La=i=>{event.stopPropagation(),E.value=i},ka=async(i,a)=>{a.stopPropagation(),await fa(i),B.value=!B.value},wa=async(i,a)=>{a.stopPropagation(),await ya(i),await V()},$=i=>{const a=i==null?void 0:i.portada;return new URL(a,import.meta.url).href},xa=i=>{const a=i.target.files[0];a&&(h.value&&URL.revokeObjectURL(h.value),k.portada=a,h.value=URL.createObjectURL(a))},M=async()=>{try{if(await ua(d.value,{nombre:C.value,descripcion:L.value}),k.portada){let i=new FormData;i.append("idLista",d.value),i.append("portada",k.portada),await pa(i)}s.value.nombre=C.value,s.value.descripcion=L.value,k.portada&&(s.value.portada=URL.createObjectURL(k.portada)),v.value=!1,m.add({severity:"success",summary:"Éxito",detail:"Lista actualizada correctamente",life:3e3})}catch(i){console.error("Error al actualizar la lista:",i),m.add({severity:"error",summary:"Error",detail:"No se pudo actualizar la lista",life:3e3})}},Ea=()=>{v.value=!1,w.value=!0},ha=async()=>{try{await ma(d.value),w.value=!1,m.add({severity:"success",summary:"Éxito",detail:"Lista eliminada correctamente",life:3e3}),sa.push("/app/biblioteca")}catch(i){console.error("Error al eliminar la lista:",i),m.add({severity:"error",summary:"Error",detail:"No se pudo eliminar la lista",life:3e3}),v.value=!0}},Ba=i=>{event.stopPropagation(),f.value=i,x.value=!0},Da=async()=>{if(f.value){try{await va(d.value,f.value.id),b.value=b.value.filter(i=>i.id!==f.value.id),x.value=!1,m.add({severity:"success",summary:"Éxito",detail:"Canción eliminada correctamente",life:3e3})}catch(i){console.error("Error al eliminar la canción:",i),m.add({severity:"error",summary:"Error",detail:"No se pudo eliminar la canción",life:3e3})}f.value=null}};return $a(async()=>{try{const[i,a]=await Promise.all([ca(d.value),da(d.value)]);C.value=s.value.nombre,L.value=s.value.descripcion,B.value=await ga(d.value),await V()}catch(i){console.error("Error cargando datos:",i)}}),(i,a)=>{var j,z,A,G,S,q,O,H,W,Y,Z,J,K,Q,X;const Fa=p("router-link"),Pa=p("InputText"),N=p("FloatLabel"),Ua=p("Textarea"),g=p("Button"),T=p("Dialog"),Ta=p("Toast");return c(),u(ia,null,[E.value?(c(),ta(qa,{key:0,cancion:E.value,onClose:a[0]||(a[0]=t=>E.value=null)},null,8,["cancion"])):F("",!0),a[21]||(a[21]=e("div",{class:"showDialog"},null,-1)),a[22]||(a[22]=e("div",{class:"show"},null,-1)),a[23]||(a[23]=e("div",{class:"showEliminar"},null,-1)),e("div",Ya,[e("div",Za,[e("div",Ja,[e("img",{src:$(o(s))},null,8,Ka)]),e("div",Qa,[e("p",null,n((j=o(s))==null?void 0:j.tipo),1),e("h1",null,n((z=o(s))==null?void 0:z.nombre),1),e("span",null,[(c(),ta(Fa,{class:"banner-creador-nombre",key:(A=o(s))==null?void 0:A.id_creador,to:{name:((q=(S=(G=i.user)==null?void 0:G.roles)==null?void 0:S[0])==null?void 0:q.name.toLowerCase())==="artista"?"artista.perfil":"app.perfil",params:{id:(O=o(s))==null?void 0:O.id_creador}}},{default:_(()=>{var t;return[ja(n((t=o(s))==null?void 0:t.creador),1)]}),_:1},8,["to"])),e("p",null,n(new Date((H=o(s))==null?void 0:H.created_at).getFullYear()),1),a[12]||(a[12]=e("p",null,"·",-1)),e("p",null,n((W=o(s))==null?void 0:W.num_canciones)+" canciones",1),a[13]||(a[13]=e("p",null,"·",-1)),e("p",null,n((Y=o(s))==null?void 0:Y.duracion_total),1)]),e("p",Xa,n((Z=o(s))==null?void 0:Z.descripcion),1)]),((J=o(U))==null?void 0:J.name)!==((K=o(s))==null?void 0:K.creador)?(c(),u("i",{key:0,id:"iconoBanner",class:I(B.value?"pi pi-heart-fill":"pi pi-heart"),onClick:a[1]||(a[1]=t=>{var y;return ka((y=o(s))==null?void 0:y.id,t)})},null,2)):F("",!0),((Q=o(U))==null?void 0:Q.name)===((X=o(s))==null?void 0:X.creador)?(c(),u("i",{key:1,class:I({"pi pi-cog":!0,"pi-spin":P.value}),id:"iconoBanner",onMouseover:a[2]||(a[2]=t=>P.value=!0),onMouseleave:a[3]||(a[3]=t=>P.value=!1),onClick:a[4]||(a[4]=t=>v.value=!0)},null,34)):F("",!0)]),e("div",{class:"lista-banner-play",onClick:ba},[o(la)?(c(),u("svg",ee,a[15]||(a[15]=[R(' Definición del degradado <defs data-v-a86cc1a9><linearGradient id="gradiente" x1="0%" y1="0%" x2="100%" y2="0%" data-v-a86cc1a9><stop offset="0%" stop-color="#F472B6" data-v-a86cc1a9></stop><stop offset="100%" stop-color="#A855F7" data-v-a86cc1a9></stop></linearGradient></defs> Círculo de fondo con degradado <circle cx="50" cy="50" r="45" fill="url(#gradiente)" stroke="none" data-v-a86cc1a9></circle> Barras de pausa (dos rectángulos) <rect x="35" y="30" width="10" height="40" fill="white" rx="2" data-v-a86cc1a9></rect><rect x="55" y="30" width="10" height="40" fill="white" rx="2" data-v-a86cc1a9></rect>',7)]))):(c(),u("svg",ae,a[14]||(a[14]=[R('<defs data-v-a86cc1a9><linearGradient id="gradiente" x1="0%" y1="0%" x2="100%" y2="0%" data-v-a86cc1a9><stop offset="0%" stop-color="#F472B6" data-v-a86cc1a9></stop><stop offset="100%" stop-color="#A855F7" data-v-a86cc1a9></stop></linearGradient></defs><circle cx="50" cy="50" r="45" fill="url(#gradiente)" stroke="none" data-v-a86cc1a9></circle><path d="M35 25 L35 75 L75 50 Z" fill="white" data-v-a86cc1a9></path>',3)])))])]),e("div",te,[a[16]||(a[16]=R('<div class="row lista-canciones-categorias" data-v-a86cc1a9><p class="col-md-1" data-v-a86cc1a9>#</p><p class="col-md-5" data-v-a86cc1a9>Título</p><p class="col-md-3" data-v-a86cc1a9>Reproducciones</p><p class="col-md-2" data-v-a86cc1a9>Duración</p></div>',1)),e("div",ie,[(c(!0),u(ia,null,Ma(o(b),(t,y)=>{var aa,ea;return c(),u("div",{class:"row cancion-lista",key:t.id,onClick:D=>Ca(t)},[e("div",null,[e("p",oe,n(y+1),1),e("p",le,n(t.nombre),1),e("p",ne,n(t.reproducciones),1),e("p",re,n(t.duracion),1),e("span",ce,[e("i",{class:I(o(_a)(t.id)?"pi pi-heart-fill":"pi pi-heart"),onClick:D=>wa(t.id,D),title:"Añadir la canción a favoritos"},null,10,de),e("i",{class:"pi pi-plus",onClick:D=>La(t),title:"Añadir la canción a una lista"},null,8,ue)])]),((aa=o(U))==null?void 0:aa.name)===((ea=o(s))==null?void 0:ea.creador)?(c(),u("i",{key:0,class:"pi pi-times-circle",style:{cursor:"pointer"},onClick:D=>Ba(t),title:"Eliminar canción de la lista"},null,8,pe)):F("",!0)],8,se)}),128))])]),l(T,{class:"crearLista-modal",visible:v.value,"onUpdate:visible":a[7]||(a[7]=t=>v.value=t),modal:"",header:"Editar lista",appendTo:".showDialog"},{default:_(()=>[e("form",{onSubmit:za(M,["prevent"])},[e("div",me,[e("div",ve,[e("div",fe,[e("img",{src:h.value||$(o(s))||"/images/placeholder1.jpg",class:"estilo_imagen"},null,8,ge),e("input",{type:"file",onChange:xa,accept:"image/*",ref:"archivoImagen",class:"añadir_archivo"},null,544)])]),e("div",ye,[e("div",_e,[l(N,{variant:"on"},{default:_(()=>[l(Pa,{class:"crearLista-input",id:"username",modelValue:C.value,"onUpdate:modelValue":a[5]||(a[5]=t=>C.value=t)},null,8,["modelValue"]),a[17]||(a[17]=e("label",{for:"username"},"Nombre de la lista",-1))]),_:1})]),e("div",be,[l(N,{variant:"on"},{default:_(()=>[l(Ua,{class:"crearLista-input",id:"config-descripcion",rows:"5",cols:"30",style:{resize:"none"},modelValue:L.value,"onUpdate:modelValue":a[6]||(a[6]=t=>L.value=t)},null,8,["modelValue"]),a[18]||(a[18]=e("label",{for:"descripcion"},"Descripción",-1))]),_:1})])])]),e("div",Ce,[l(g,{type:"button",id:"cancelarButton",label:"Guardar",onClick:M}),l(g,{type:"button",id:"eliminarButton",label:"Eliminar",severity:"danger",onClick:Ea,title:"Eliminar la lista permanentemente"})])],32)]),_:1},8,["visible"]),l(T,{visible:x.value,"onUpdate:visible":a[9]||(a[9]=t=>x.value=t),modal:"",header:"Confirmar eliminación",class:"confirmarEliminacion",appendTo:".show"},{default:_(()=>{var t;return[e("p",null,'¿Estás seguro de que quieres eliminar la canción "'+n((t=f.value)==null?void 0:t.nombre)+'" de la lista?',1),a[19]||(a[19]=e("p",{class:"text-red-500"},"Esta acción no se puede deshacer.",-1)),e("div",Le,[l(g,{type:"button",label:"Cancelar",id:"cancelarButton",onClick:a[8]||(a[8]=y=>x.value=!1)}),l(g,{type:"button",label:"Eliminar",id:"eliminarButton",onClick:Da})])]}),_:1},8,["visible"]),l(T,{visible:w.value,"onUpdate:visible":a[11]||(a[11]=t=>w.value=t),modal:"",header:"Confirmar eliminación de lista",class:"confirmarEliminacion",appenTo:".showEliminar"},{default:_(()=>{var t;return[e("p",null,'¿Estás seguro de que quieres eliminar la lista "'+n((t=o(s))==null?void 0:t.nombre)+'"?',1),a[20]||(a[20]=e("p",{class:"text-red-500"},"Esta acción no se puede deshacer y eliminará permanentemente la lista.",-1)),e("div",ke,[l(g,{type:"button",label:"Cancelar",class:"boton_cancelar",onClick:a[10]||(a[10]=y=>w.value=!1)}),l(g,{type:"button",label:"Eliminar",severity:"danger",id:"eliminarButton",onClick:ha})])]}),_:1},8,["visible"]),l(Ta)],64)}}},Re=Wa(we,[["__scopeId","data-v-a86cc1a9"]]);export{Re as default};
