import{p as d,M as h,H as i}from"./app-BArZ-JoB.js";function x(){const u=d({data:[]}),c=d({}),l=d({}),r=d(!1),o=h(),p=async()=>{r.value=!0;try{const t=await i.get("/api/admin/canciones");u.value=t.data,r.value=!1}catch{r.value=!1,o.add({severity:"error",summary:"Error",detail:"Error al cargar las canciones",life:3e3})}},f=async t=>{r.value=!0;try{const a=await i.get(`/api/admin/canciones/${t}`);return c.value=a.data.data,r.value=!1,c.value}catch(a){throw r.value=!1,o.add({severity:"error",summary:"Error",detail:"Error al cargar los detalles de la canción",life:3e3}),a}},m=async t=>{try{const e=(await i.get(`/api/admin/albums/${t}/canciones`)).data.data||[];if(!e.length)return 1;let n=0;return e.forEach(s=>{var y;const v=((y=s.pivot)==null?void 0:y.orden)||0;v>n&&(n=v)}),n+1}catch(a){return console.error("Error al obtener el siguiente orden:",a),9999}};return{canciones:u,cancion:c,errors:l,loading:r,getCanciones:p,getCancion:f,storeCancion:async t=>{r.value=!0,l.value={};try{let a=1;t.album_id&&(a=await m(t.album_id));const e=new FormData;for(const s in t)(s==="archivo"||s==="portada")&&t[s]instanceof File,e.append(s,t[s]);e.append("orden",a);const n=await i.post("/api/admin/canciones",e,{headers:{"Content-Type":"multipart/form-data"}});return c.value=n.data.cancion,r.value=!1,o.add({severity:"success",summary:"Éxito",detail:"Canción creada correctamente",life:3e3}),n}catch(a){throw a.response&&a.response.status===422&&(l.value=a.response.data.errors),r.value=!1,o.add({severity:"error",summary:"Error",detail:"Error al crear la canción",life:3e3}),a}},updateCancion:async(t,a)=>{r.value=!0,l.value={};try{const e=a.get("album_id");if(e&&c.value.album_id!==e){const s=await m(e);a.append("orden",s)}const n=await i.post(`/api/admin/canciones/${t}`,a,{headers:{"Content-Type":"multipart/form-data"}});return c.value=n.data.data,r.value=!1,o.add({severity:"success",summary:"Éxito",detail:"Canción actualizada correctamente",life:3e3}),n}catch(e){throw e.response&&e.response.status===422&&(l.value=e.response.data.errors),r.value=!1,o.add({severity:"error",summary:"Error",detail:"Error al actualizar la canción",life:3e3}),e}},deleteCancion:async t=>{r.value=!0;try{await i.delete(`/api/admin/canciones/${t}`),p(),r.value=!1,o.add({severity:"success",summary:"Éxito",detail:"Canción eliminada correctamente",life:3e3})}catch(a){throw r.value=!1,o.add({severity:"error",summary:"Error",detail:"Error al eliminar la canción",life:3e3}),a}},updateAudio:async(t,a)=>{r.value=!0;const e=new FormData;e.append("id",t),e.append("archivo",a);try{const n=await i.post("/api/admin/canciones/updateaudio",e,{headers:{"Content-Type":"multipart/form-data"}});return r.value=!1,o.add({severity:"success",summary:"Éxito",detail:"Archivo de audio actualizado correctamente",life:3e3}),n.data}catch(n){throw r.value=!1,o.add({severity:"error",summary:"Error",detail:"Error al actualizar el archivo de audio",life:3e3}),n}}}}export{x as u};
