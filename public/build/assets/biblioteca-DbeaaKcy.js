import{A as R,p as m,H as j,D as N,C as O,b as k,h as e,v as r,k as c,x as u,F as h,i as C,f as b,o as d,d as D,t as V,P as S}from"./app-BArZ-JoB.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";function H(){const B=R().user,f=R(),_=m([]),w=m([]),y=m([]),p=m(null),n=m({nombre:"",descripcion:"",portada:null,duracion_total:"00:00:00"}),g=async()=>{try{const s=await j.get(`/api/listas/${B.id}`);_.value=s.data.data}catch(s){console.error("Error encontrando listas:",s)}},U=async()=>{if(!f.user)return console.warn("El usuario no está autenticado"),!1;try{const s=await j.get("/api/mostrar/lista/likes");w.value=s.data.data}catch(s){return console.error("Error al encontrar las listas favoritas",s),!1}},i=async()=>{if(!f.user)return console.warn("El usuario no está autenticado"),!1;try{const s=await j.get("/api/mostrar/album/likes");y.value=s.data.data}catch(s){return console.error("Error al encontrar los álbumes favoritos",s),!1}},l=()=>{n.value={nombre:"",descripcion:"",portada:null,duracion_total:"00:00:00"},p.value&&URL.revokeObjectURL(p.value),p.value=null};return{listas:_,listasFavoritas:w,albumesFavoritos:y,listaData:n,PreviewImagenLista:p,getListasUsuario:g,getListasFavs:U,getAlbumesFavs:i,enviarFormulario:async()=>{var s;try{const o=new FormData;o.append("nombre",n.value.nombre),o.append("portada",n.value.portada),o.append("duracion_total",n.value.duracion_total),n.value.descripcion.trim()!==""&&o.append("descripcion",n.value.descripcion);const v=await j.post("/api/listas",o,{headers:{"Content-Type":"multipart/form-data"}});return console.log("Lista creada exitosamente",v.data),v.data.lista?_.value.push(v.data.lista):console.error("Error: la respuesta no contiene la lista esperada.",v.data),l(),!0}catch(o){return console.error("Error:",(s=o.response)==null?void 0:s.data),!1}},resetFormulario:l}}const G={class:"biblioteca-top"},Y={class:"biblioteca-content"},J={class:"biblioteca-tusListas"},K=["src","alt"],Q={class:"biblioteca-favoritos"},W={class:"biblioteca-favoritos-tarjetas"},X=["src","alt"],Z={class:"biblioteca-favoritos-tarjetas",id:"albumsFavs"},aa=["src","alt"],ea={class:"row"},ta={class:"config-imagenes col-md-4"},sa={class:"imagen-crear-lista"},oa=["src"],ra={class:"col-md-6"},na={class:"flex items-center gap-4 mb-4"},ia={class:"flex items-center gap-4 mb-8"},la={class:"flex justify-end gap-2"},ca={__name:"biblioteca",setup(B){const{getListasUsuario:f,listas:_,getListasFavs:w,listasFavoritas:y,getAlbumesFavs:p,albumesFavoritos:n,enviarFormulario:g,resetFormulario:U,listaData:i,PreviewImagenLista:l}=H(),F=m(!1),s=m(!1);N(async()=>{await f(),await w(),await p()});function o(L){let a=L.portada;return new URL(a,import.meta.url).href}const v=L=>{const a=L.target.files[0];a&&(l.value&&URL.revokeObjectURL(l.value),i.value.portada=a,l.value=URL.createObjectURL(a))},T=O(()=>i.value.nombre.trim()!==""&&i.value.portada),M=async()=>{await g()&&(await f(),F.value=!1)};return(L,a)=>{const x=b("router-link"),P=b("InputText"),E=b("FloatLabel"),$=b("Textarea"),z=b("Button"),A=b("Dialog");return d(),k(h,null,[a[13]||(a[13]=e("div",{class:"show"},null,-1)),e("div",G,[a[7]||(a[7]=e("h1",null,"Tu Biblioteca",-1)),e("i",{class:"pi pi-plus",style:{"font-size":"2rem"},onMouseover:a[0]||(a[0]=t=>s.value=!0),onMouseleave:a[1]||(a[1]=t=>s.value=!1),onClick:a[2]||(a[2]=t=>{F.value=!0,r(U)()}),title:"Crear una lista nueva"},null,32)]),e("div",Y,[e("div",J,[c(x,{to:{name:"app.likes"},class:"biblioteca_tarjeta"},{default:u(()=>a[8]||(a[8]=[e("img",{src:"/images/imgLikes.jpg",class:"imagen_caja",alt:"Fondo degradado con corazón blanco en el centro"},null,-1),e("p",null,"Mis Favoritos",-1)])),_:1}),(d(!0),k(h,null,C(r(_),(t,I)=>(d(),D(x,{to:{name:"app.lista",params:{id:t.id}},class:"biblioteca_tarjeta",key:t.id},{default:u(()=>[e("img",{src:o(t),alt:t.nombre,class:"imagen_caja"},null,8,K),e("p",null,V(t.nombre),1)]),_:2},1032,["to"]))),128))]),e("div",Q,[a[9]||(a[9]=e("h2",null,"Listas Favoritas",-1)),e("div",W,[(d(!0),k(h,null,C(r(y),(t,I)=>(d(),D(x,{to:{name:"app.lista",params:{id:t.id}},class:"biblioteca_tarjeta",key:t.id},{default:u(()=>[e("img",{src:o(t),alt:t.nombre,class:"imagen_caja"},null,8,X),e("p",null,V(t.nombre),1)]),_:2},1032,["to"]))),128))]),a[10]||(a[10]=e("h2",null,"Álbumes Favoritos",-1)),e("div",Z,[(d(!0),k(h,null,C(r(n),(t,I)=>(d(),D(x,{to:{name:"app.album",params:{id:t.id}},class:"biblioteca_tarjeta",key:t.id},{default:u(()=>[e("img",{src:o(t),alt:t.nombre,class:"imagen_caja"},null,8,aa),e("p",null,V(t.nombre),1)]),_:2},1032,["to"]))),128))])])]),c(A,{class:"crearLista-modal",visible:F.value,"onUpdate:visible":a[6]||(a[6]=t=>F.value=t),modal:"",header:"Crea una lista",appendTo:".show"},{default:u(()=>[e("form",{onSubmit:a[5]||(a[5]=S((...t)=>r(g)&&r(g)(...t),["prevent"]))},[e("div",ea,[e("div",ta,[e("div",sa,[e("img",{src:r(l)||"/images/placeholder1.jpg",class:"estilo_imagen"},null,8,oa),e("input",{type:"file",onChange:v,accept:"image/*",ref:"archivoImagen",class:"añadir_archivo",required:""},null,544)])]),e("div",ra,[e("div",na,[c(E,{variant:"on"},{default:u(()=>[c(P,{class:"crearLista-input",id:"username",modelValue:r(i).nombre,"onUpdate:modelValue":a[3]||(a[3]=t=>r(i).nombre=t),required:"",maxlength:"45"},null,8,["modelValue"]),a[11]||(a[11]=e("label",{for:"username"},"Nombre de la lista",-1))]),_:1})]),e("div",ia,[c(E,{variant:"on"},{default:u(()=>[c($,{class:"crearLista-input",id:"config-descripcion",rows:"5",cols:"30",style:{resize:"none"},modelValue:r(i).descripcion,"onUpdate:modelValue":a[4]||(a[4]=t=>r(i).descripcion=t),maxlength:"200"},null,8,["modelValue"]),a[12]||(a[12]=e("label",{for:"descripcion"},"Descripción",-1))]),_:1})])])]),e("div",la,[c(z,{type:"button",label:"Guardar",onClick:M,disabled:!T.value},null,8,["disabled"])])],32)]),_:1},8,["visible"])],64)}}},ma=q(ca,[["__scopeId","data-v-31bfd290"]]);export{ma as default};
